<?xml version="1.0"  ?><!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd"><pmc-articleset><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xml:lang="en" article-type="research-article" dtd-version="1.4"><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">J Clin Med</journal-id><journal-id journal-id-type="iso-abbrev">J Clin Med</journal-id><journal-id journal-id-type="pmc-domain-id">2745</journal-id><journal-id journal-id-type="pmc-domain">jclinmed</journal-id><journal-id journal-id-type="publisher-id">jcm</journal-id><journal-title-group><journal-title>Journal of Clinical Medicine</journal-title></journal-title-group><issn pub-type="epub">2077-0383</issn><publisher><publisher-name>Multidisciplinary Digital Publishing Institute  (MDPI)</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">PMC11355543</article-id><article-id pub-id-type="pmcid-ver">PMC11355543.1</article-id><article-id pub-id-type="pmcaid">11355543</article-id><article-id pub-id-type="pmcaiid">11355543</article-id><article-id pub-id-type="pmid">39200967</article-id><article-id pub-id-type="doi">10.3390/jcm13164825</article-id><article-id pub-id-type="publisher-id">jcm-13-04825</article-id><article-version article-version-type="pmc-version">1</article-version><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Analyzing Dropout in Alcohol Recovery Programs: A Machine Learning Approach</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0009-0004-7544-0753</contrib-id><name name-style="western"><surname>Collin</surname><given-names initials="A">Adele</given-names></name><xref rid="af1-jcm-13-04825" ref-type="aff">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-8638-4601</contrib-id><name name-style="western"><surname>Ayuso-Mu&#241;oz</surname><given-names initials="A">Adri&#225;n</given-names></name><xref rid="af2-jcm-13-04825" ref-type="aff">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-0342-6640</contrib-id><name name-style="western"><surname>Tejera-Nevado</surname><given-names initials="P">Paloma</given-names></name><xref rid="af2-jcm-13-04825" ref-type="aff">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-1545-3515</contrib-id><name name-style="western"><surname>Prieto-Santamar&#237;a</surname><given-names initials="L">Luc&#237;a</given-names></name><xref rid="af2-jcm-13-04825" ref-type="aff">2</xref><xref rid="af3-jcm-13-04825" ref-type="aff">3</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Verdejo-Garc&#237;a</surname><given-names initials="A">Antonio</given-names></name><xref rid="af4-jcm-13-04825" ref-type="aff">4</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-3392-4683</contrib-id><name name-style="western"><surname>D&#237;az-Batanero</surname><given-names initials="C">Carmen</given-names></name><xref rid="af5-jcm-13-04825" ref-type="aff">5</xref><xref rid="af6-jcm-13-04825" ref-type="aff">6</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-2981-1670</contrib-id><name name-style="western"><surname>Fern&#225;ndez-Calder&#243;n</surname><given-names initials="F">Ferm&#237;n</given-names></name><xref rid="af5-jcm-13-04825" ref-type="aff">5</xref><xref rid="af6-jcm-13-04825" ref-type="aff">6</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Albein-Urios</surname><given-names initials="N">Natalia</given-names></name><xref rid="af7-jcm-13-04825" ref-type="aff">7</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-2722-6563</contrib-id><name name-style="western"><surname>Lozano</surname><given-names initials="&#xD3;M">&#211;scar M.</given-names></name><xref rid="af5-jcm-13-04825" ref-type="aff">5</xref><xref rid="af6-jcm-13-04825" ref-type="aff">6</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-8801-4762</contrib-id><name name-style="western"><surname>Rodr&#237;guez-Gonz&#225;lez</surname><given-names initials="A">Alejandro</given-names></name><xref rid="af2-jcm-13-04825" ref-type="aff">2</xref><xref rid="af3-jcm-13-04825" ref-type="aff">3</xref><xref rid="c1-jcm-13-04825" ref-type="corresp">*</xref></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name name-style="western"><surname>Abedi</surname><given-names initials="V">Vida</given-names></name><role>Academic Editor</role></contrib><contrib contrib-type="editor"><name name-style="western"><surname>Guillen-Grima</surname><given-names initials="F">Francisco</given-names></name><role>Academic Editor</role></contrib></contrib-group><aff id="af1-jcm-13-04825"><label>1</label>CentraleSup&#233;lec, Universit&#233; Paris-Saclay, 91190 Gif-sur-Yvette, France</aff><aff id="af2-jcm-13-04825"><label>2</label>Centro de Tecnolog&#237;a Biom&#233;dica, Universidad Polit&#233;cnica de Madrid, 28223 Pozuelo de Alarc&#243;n, Spain</aff><aff id="af3-jcm-13-04825"><label>3</label>Escuela T&#233;cnica Superior de Ingenieros Inform&#225;ticos, Universidad Polit&#233;cnica de Madrid, 28660 Boadilla del Monte, Spain</aff><aff id="af4-jcm-13-04825"><label>4</label>Turner Institute for Brain and Mental Health, Monash University, Melbourne, VIC 3800, Australia</aff><aff id="af5-jcm-13-04825"><label>5</label>Clinical and Experimental Psychology Department, University of Huelva, 21071 Huelva, Spain</aff><aff id="af6-jcm-13-04825"><label>6</label>Research Center for Natural Resources, Health and the Environment, University of Huelva, 21071 Huelva, Spain</aff><aff id="af7-jcm-13-04825"><label>7</label>Discipline of Psychology, Federation University, Berwick, VIC 3806, Australia</aff><author-notes><corresp id="c1-jcm-13-04825"><label>*</label>Correspondence: <email>alejandro.rg@upm.es</email></corresp></author-notes><pub-date pub-type="epub"><day>15</day><month>8</month><year>2024</year></pub-date><pub-date pub-type="collection"><month>8</month><year>2024</year></pub-date><volume>13</volume><issue>16</issue><issue-id pub-id-type="pmc-issue-id">469543</issue-id><elocation-id>4825</elocation-id><history><date date-type="received"><day>12</day><month>6</month><year>2024</year></date><date date-type="rev-recd"><day>12</day><month>8</month><year>2024</year></date><date date-type="accepted"><day>13</day><month>8</month><year>2024</year></date></history><pub-history><event event-type="pmc-release"><date><day>15</day><month>08</month><year>2024</year></date></event><event event-type="pmc-live"><date><day>29</day><month>08</month><year>2024</year></date></event><event event-type="pmc-last-change"><date iso-8601-date="2024-09-01 13:25:13.907"><day>01</day><month>09</month><year>2024</year></date></event></pub-history><permissions><copyright-statement>&#169; 2024 by the authors.</copyright-statement><copyright-year>2024</copyright-year><license><ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p></license></permissions><self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pmc-pdf" xlink:href="jcm-13-04825.pdf"/><abstract><p><bold>Background</bold>: Retention in treatment is crucial for the success of interventions targeting alcohol use disorder (AUD), which affects over 100 million people globally. Most previous studies have used classical statistical techniques to predict treatment dropout, and their results remain inconclusive. This study aimed to use novel machine learning tools to identify models that predict dropout with greater precision, enabling the development of better retention strategies for those at higher risk. <bold>Methods</bold>: A retrospective observational study of 39,030 (17.3% female) participants enrolled in outpatient-based treatment for alcohol use disorder in a state-wide public treatment network has been used. Participants were recruited between 1 January 2015 and 31 December 2019. We applied different machine learning algorithms to create models that allow one to predict the premature cessation of treatment (dropout). With the objective of increasing the explainability of those models with the best precision, considered as black-box models, explainability technique analyses were also applied. <bold>Results</bold>: Considering as the best models those obtained with one of the so-called black-box models (support vector classifier (SVC)), the results from the best model, from the explainability perspective, showed that the variables that showed greater explanatory capacity for treatment dropout are previous drug use as well as psychiatric comorbidity. Among these variables, those of having undergone previous opioid substitution treatment and receiving coordinated psychiatric care in mental health services showed the greatest capacity for predicting dropout. <bold>Conclusions</bold>: By using novel machine learning techniques on a large representative sample of patients enrolled in alcohol use disorder treatment, we have identified several machine learning models that help in predicting a higher risk of treatment dropout. Previous treatment for other substance use disorders (SUDs) and concurrent psychiatric comorbidity were the best predictors of dropout, and patients showing these characteristics may need more intensive or complementary interventions to benefit from treatment.</p></abstract><kwd-group><kwd>alcohol use disorder</kwd><kwd>treatment</kwd><kwd>outpatients</kwd><kwd>machine learning</kwd><kwd>outcomes</kwd><kwd>dropout</kwd><kwd>real-world data</kwd></kwd-group><funding-group><award-group><funding-source>Fondo Europeo de Desarrollo Regional (EU) and Junta de Andaluc&#237;a (Spain)</funding-source><award-id>P20_00735</award-id></award-group><funding-statement>This study was supported by the grant &#8220;COMPARA: Comorbilidad Psiqui&#225;trica en Adicciones y Resultados en Andaluc&#237;a. Modelizaci&#243;n a trav&#233;s de Big Data&#8221;, project P20_00735 in the Andalusian Research, Development, and Innovation Plan, provided by the Fondo Europeo de Desarrollo Regional (EU) and Junta de Andaluc&#237;a (Spain).</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>pmc-status-qastatus</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>pmc-status-live</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-status-embargo</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-status-released</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-open-access</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-olf</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-manuscript</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-legally-suppressed</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-has-pdf</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-has-supplement</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-pdf-only</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-suppress-copyright</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-is-real-version</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-is-scanned-article</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-preprint</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-in-epmc</meta-name><meta-value>yes</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec sec-type="intro" id="sec1-jcm-13-04825"><title>1. Introduction</title><p>Alcohol consumption is a leading cause of more than 200 diseases, injuries, and health conditions. Excessive and hazardous alcohol use poses a significant risk for the development of mental and behavioral disorders, including alcohol use disorder (AUD), as well as major noncommunicable diseases. To reduce harmful alcohol use in line with Sustainable Development Goals (SDGs) 2030 targets and the WHO Global Monitoring Framework, new research on preventive, harm reduction, and treatment pathways which engages key stakeholders (e.g., government treatment networks) is crucial [<xref rid="B1-jcm-13-04825" ref-type="bibr">1</xref>].</p><p>In regard to treatment seeking for drug abuse, alcohol is either the primary or secondary drug for almost half a million people in the USA [<xref rid="B2-jcm-13-04825" ref-type="bibr">2</xref>]. In the case of Spain, which is one of the European countries that systematically collects information on addiction treatment admissions, over one in three admissions are due to alcohol [<xref rid="B3-jcm-13-04825" ref-type="bibr">3</xref>]. Although there is a range of evidence-based treatments for AUD [<xref rid="B4-jcm-13-04825" ref-type="bibr">4</xref>,<xref rid="B5-jcm-13-04825" ref-type="bibr">5</xref>,<xref rid="B6-jcm-13-04825" ref-type="bibr">6</xref>], they have pervasive limitations, particularly their low retention and engagement rates [<xref rid="B7-jcm-13-04825" ref-type="bibr">7</xref>]. Specifically, both nation-wide and international studies show that more than half of the patients undergoing treatment had previously received treatment for their addiction [<xref rid="B2-jcm-13-04825" ref-type="bibr">2</xref>,<xref rid="B3-jcm-13-04825" ref-type="bibr">3</xref>].</p><p>From an epidemiological perspective, there are several correlates (medical, psychological, social) associated with AUD that hamper engagement and ultimately recovery [<xref rid="B8-jcm-13-04825" ref-type="bibr">8</xref>]. These variables have also been integrated into theoretical models to explain their relationships during the therapeutic process [<xref rid="B9-jcm-13-04825" ref-type="bibr">9</xref>,<xref rid="B10-jcm-13-04825" ref-type="bibr">10</xref>]. These models indicate that time in treatment, as well as premature dropouts, have a negative impact on the patient&#8217;s therapeutic prognosis. In fact, more than half of readmissions to treatment occur with patients who have dropped out of treatment without achieving the therapeutic objectives [<xref rid="B11-jcm-13-04825" ref-type="bibr">11</xref>,<xref rid="B12-jcm-13-04825" ref-type="bibr">12</xref>]. For this reason, reducing dropouts in treatment is one of the clinical and managerial targets to achieving a more efficient and effective treatment.</p><p>As some authors point out [<xref rid="B13-jcm-13-04825" ref-type="bibr">13</xref>,<xref rid="B14-jcm-13-04825" ref-type="bibr">14</xref>], machine learning (ML) techniques can provide strong benefits in the substance abuse field relative to traditional techniques, as they can uncover hidden relationships in the data, which can help to improve clinical decisions. They have the potential to identify if a given patient could drop out from the therapeutic process, and consequently, to trigger additional support for those users with a higher likelihood of dropout. The creation of ML models not only will allow the potential use of such models but also assist in seeing what are the most relevant features that are influencing a concrete output. This can help in having a better understanding of what the factors (psychological, clinical, societal, etc.) driving the decision to drop out are, and can help professionals in providing better patient care.</p><p>In recent years, various studies have applied ML techniques to predict dropouts and relapses in the context of addiction treatment. So far, studies with a sampling ranging from 275 to 1383 patients [<xref rid="B15-jcm-13-04825" ref-type="bibr">15</xref>,<xref rid="B16-jcm-13-04825" ref-type="bibr">16</xref>,<xref rid="B17-jcm-13-04825" ref-type="bibr">17</xref>,<xref rid="B18-jcm-13-04825" ref-type="bibr">18</xref>,<xref rid="B19-jcm-13-04825" ref-type="bibr">19</xref>,<xref rid="B20-jcm-13-04825" ref-type="bibr">20</xref>] have used different techniques of ML to predict AUD treatment outcomes. According to the authors of [<xref rid="B13-jcm-13-04825" ref-type="bibr">13</xref>], the ML method demonstrated its superiority in predicting outcomes compared to other techniques. However, they also suggest important limitations associated with the ecological validity of these techniques.</p><p>In this context, for those models typically considered black-box models (not providing interpretability), a set of techniques to try to provide model explainability will be applied. In this regard, the main aims of this study are as follows: (i) to study different types of machine learning algorithms over a dataset of patients that have discontinued (or not) the therapeutic process, to investigate their usefulness in identifying patients with a higher risk of dropping out; and (ii) to pinpoint the most relevant variables predicting treatment dropout in AUD patients.</p></sec><sec id="sec2-jcm-13-04825"><title>2. Material and Methods</title><sec id="sec2dot1-jcm-13-04825"><title>2.1. Dataset Description</title><p>The original dataset consisted of 39,030 patients with AUD. All patients started treatment at any of the 121 public and subsidized addiction treatment centers in Andalusia (a region of Spain with more than 8,000,000 inhabitants) from 1 January 2015 to 15 September 2021. From this dataset, patients with no treatment completion data were excluded (7943 patients), as they could not be used in the training phase because we do not know the output of the therapeutic process. The data for the analysis contained a total of 31,087 patients.</p><p>The data utilized in this study are derived from the Electronic Health Records (EHRs) of the Information System of the Andalusian Plan on Drugs (SiPASDA), which maintains a centralized dataset for all addiction centers. The EHR stores various information following the standards outlined by the European Monitoring Centre for Drugs and Drug Addiction [<xref rid="B21-jcm-13-04825" ref-type="bibr">21</xref>]. This includes sociodemographic variables, drug use history, previous treatments, and infectious diseases. The SiPASDA data have been used in previous studies, demonstrating the reliability of the records [<xref rid="B22-jcm-13-04825" ref-type="bibr">22</xref>], as well as their utility for understanding the evolution of patients and their therapeutic outcomes during treatment [<xref rid="B9-jcm-13-04825" ref-type="bibr">9</xref>,<xref rid="B11-jcm-13-04825" ref-type="bibr">11</xref>,<xref rid="B23-jcm-13-04825" ref-type="bibr">23</xref>].</p><p>The storage and encoding of these data adhere to the General Health Law dated 25 April 1986 (Spain), as well as Law 41/2002 passed on November 14, which pertains to patient autonomy, rights, and obligations regarding clinical information and documentation. Furthermore, it complies with the Organic Law 3/2018 enacted on 5 December 2018, which focuses on safeguarding personal data and ensuring digital rights in accordance with European regulations. </p><p>The Andalusian Ministry of Health&#8217;s Research Ethics Committee confirmed that the information was handled in accordance with its ethical standards.</p></sec><sec id="sec2dot2-jcm-13-04825"><title>2.2. Methodological Approach</title><p>The methodology employed in the analysis and model creation is based on the Cross-Industry Process for Data Mining (CRISP-DM) [<xref rid="B24-jcm-13-04825" ref-type="bibr">24</xref>], a comprehensive framework for developing machine learning models. This methodology encompasses phases from business understanding to deployment, ensuring a systematic approach. The primary business objective is to reduce the dropout rate from addiction treatment programs by predicting patients at a high risk of early departure. The initial data comprised 215 variables and was reduced to 129 through filtering out irrelevant or highly null variables. A further dimensionality reduction involved clustering mental disorders and applying a gain ratio for variable selection, resulting in a final dataset of 19 predictors. Multiple machine learning algorithms, including logistic regression, support vector classifiers, decision trees, random forests, bagging, boosting, and neural networks, were evaluated using 10-fold cross-validation. Class imbalance was addressed through oversampling techniques like SMOTE and Tomek links. Hyperparameter tuning was performed via randomized search, optimizing for precision to minimize false positives. Model explainability was enhanced using SHAP values to interpret the influence of input features. The entire process was executed using R and Python, with experiments conducted on a high-performance computing setup, and all results were made publicly available to ensure reproducibility. The following subsections explain the different steps that belong to this methodology in more detail. Finally, in the available online (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://medal.ctb.upm.es/internal/gitlab/compara/mldropoutalcohol">https://medal.ctb.upm.es/internal/gitlab/compara/mldropoutalcohol</uri> accessed on 12 August 2024) repository, all the relevant details of each CRISP-DM phase are described.</p><p><italic toggle="yes">Business understanding</italic>: The main business objective is to reduce the dropout rate of patients from addiction treatment programs by identifying individuals at a higher risk of leaving the treatment early. This can help in customizing interventions, improving patient engagement, and ultimately enhancing treatment outcomes. Understanding the factors that contribute to treatment discontinuation can also inform program improvements and policy adjustments. Hence, the aim of the associated data mining is to develop a predictive model that can estimate the likelihood of a patient discontinuing their addiction treatment.</p><sec id="sec2dot2dot1-jcm-13-04825"><title>2.2.1. Data Understanding and Data Preparation: Variables Description and Dataset Creation</title><p>The initial dataset contained a total of 215 variables, this being a high-dimensional dataset. In order to reduce the complexity of the problem and maximize the inclusion of variables with a higher potential for predictive purposes, a detailed analysis of the available variables was performed to select the most relevant ones. First, we only kept those variables with values in at least 60% of the rows (discarding those with &gt;40% of null values). Additionally, categorical data features were retained if the number of possible values for those features was less than 20 values, to maintain manageable and meaningful data representations. Other potential variables without predictive value (such as Identifiers (IDs)) were also removed. After this process, the performed reduction resulted in a new dataset with a total of 129 variables and the aforementioned 31,087 patients.</p><sec><title>Dimensionality Reduction: Mental Disorder Clustering</title><p>A second dimensionality reduction process was also performed, considering as input the 129 variables and the 31,087 patients derived from the previous process. In this case, mental disorders were grouped into more general categories that integrated disorders with close descriptive similarities (categories of disorders from the ICD-10 classification). This second process led to creating a second dataset with a total of 50 variables and 31,087 patients.</p></sec><sec><title>Dimensionality Reduction: Variable Filtering</title><p>A second step to reduce the dimensionality of the dataset and to try to obtain better predictors was carried out by performing variable filtering. In this case, a subset of the variables was selected using a univariate filtering approach named gain ratio [<xref rid="B25-jcm-13-04825" ref-type="bibr">25</xref>], a metric derived from their mutual information. This method is a specific instance of a broader concept known as relative entropy. Mutual information can be seen as the reduction in uncertainty about a given variable after observing another variable. The information gain ratio technique normalizes mutual information by considering the entropy value of each variable. This is necessary, since mutual information favors variables with many different values.</p><p>The top 20 predictor variables ranked by the gain ratio between the variables and the output became part of the selected feature subset. It is important to note that univariate approaches do not measure correlation. Therefore, to eliminate highly correlated variables, the correlation matrix between the features was analyzed, and variables with a correlation coefficient greater than 0.75 were excluded. By using this method, a total of 19 variables were selected, irrespective of the original dataset. The concrete list of variables selected by each subdataset (cluster/no cluster) is available online (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://medal.ctb.upm.es/internal/gitlab/compara/mldropoutalcohol/blob/master/results/filtering_discretization.txt">https://medal.ctb.upm.es/internal/gitlab/compara/mldropoutalcohol/blob/master/results/filtering_discretization.txt</uri> accessed on 12 August 2024). The selected variables can be classified into the following categories:<list list-type="bullet"><list-item><p>Consequences of alcohol consumption on the patient&#8217;s life, namely, road accidents while intoxicate, administrative sanctions, work absenteeism, loss of employment, conflicts with partners, and other problems that are due to alcohol use (e.g., legal problems, risk of social exclusion);</p></list-item><list-item><p>Addictions other than alcohol use disorders, such as abuse or dependence on hypno-sedatives, stimulants other than cocaine, pathological gambling, and whether the patient has already received opioid substitution treatment;</p></list-item><list-item><p>Comorbidity with mental disorders other than addictions;</p></list-item><list-item><p>Personal details of the patient&#8217;s living arrangements, such as where they have lived or whether they live with family members with addictions;</p></list-item><list-item><p>Physical health indicators such as transaminase levels, which can be a symptom of liver disease;</p></list-item><list-item><p>Previous treatment for addictions and mental health.</p></list-item></list></p><p>Finally, to have a better understanding of the results derived from the &#8220;data understanding/data preparation&#8221; process, including the reduction of the dimensionality of the dataset by applying the typical dataset preparation (<xref rid="sec2dot2dot1-jcm-13-04825" ref-type="sec">Section 2.2.1</xref>), the clustering process (first subsection of <xref rid="sec2dot2dot1-jcm-13-04825" ref-type="sec">Section 2.2.1</xref>), and the variable filtering (second subsection of <xref rid="sec2dot2dot1-jcm-13-04825" ref-type="sec">Section 2.2.1</xref>), <xref rid="jcm-13-04825-f001" ref-type="fig">Figure 1</xref> is shown.</p><p><xref rid="jcm-13-04825-f001" ref-type="fig">Figure 1</xref> shows the different datasets that were generated. In the root, we have the original dataset (number of features (nfts) = 215; population (N) = 39,030). The second-level dataset corresponds to the first filtering (number of features (nfts) = 129; population (N) = 31,087). That is, after removing irrelevant variables (those with a high number of null values/categories or without semantic predictive potential), we have our &#8220;Reducted dataset&#8221;. The third-level datasets are the cluster dataset (which is the one where the mental disorders were clustered (leading to 50 features)) and the no cluster dataset (where the original specific mental disorders were maintained (maintaining 129 features)). In the leaf nodes (in gray), we have the final 4 datasets that were used for the creation of the machine learning models. Filtering and no filtering are explained in the next section.</p></sec></sec></sec><sec id="sec2dot3-jcm-13-04825"><title>2.3. Outcome</title><p>The dependent variable was discontinuation of treatment. A patient was considered to have abandoned treatment when, according to clinical judgement, they had not achieved their therapeutic goals and had not visited the treatment center for more than six months.</p><p>In the final dataset of 31,087 patients, 78% of them had eventually dropped the treatment, while 22% of them successfully completed it. This imbalance between the two classes of the outcome variable has been addressed as described in the following section.</p></sec><sec id="sec2dot4-jcm-13-04825"><title>2.4. Model Selection and Training</title><p>We conducted an in-depth analysis, comparing different algorithms to ensure that we identify the best option for our aim of predicting discontinuation of the therapeutic process [<xref rid="B26-jcm-13-04825" ref-type="bibr">26</xref>]. In this case, we have considered 7 algorithms for evaluation.</p><list list-type="bullet"><list-item><p>Simple models: The first group consisted of three &#8220;simple&#8221; models, namely logistic regression, support vector classifier (SVC), and classification tree;</p></list-item><list-item><p>Meta-classifiers: Additionally, three meta-classifiers, namely random forest, bagging, and boosting, using decision trees as an estimator, were utilized;</p></list-item><list-item><p>Neural networks: Lastly, a neural network model in the form of a multi-layer perceptron (MLP) was also employed to complete the set of selected models.</p></list-item></list><p>The training and evaluation process has been carried out using a 10 K-fold cross-validation strategy, where each fold is used once as the testing subset, and the remaining folds are used for training the model. This approach involves dividing the dataset into 10 equally sized folds or subsets, ensuring that each fold serves as the testing subset exactly once during the cross-validation process. To address the class imbalance during the training of the models, we considered the use of oversampling techniques. Although the percentage of elements in the minority class (22%), considering the sample size (31,087), was enough to consider the application of an undersampling over the majority class, we have considered oversampling to addresses class imbalance by augmenting the minority class, thereby preserving valuable information and enhancing the model&#8217;s performance without the loss of critical data inherent in undersampling strategies. Concretely, the Synthetic Minority Over-Sampling Technique (SMOTE) [<xref rid="B27-jcm-13-04825" ref-type="bibr">27</xref>] and the Tomek links [<xref rid="B28-jcm-13-04825" ref-type="bibr">28</xref>] methods were employed to balance the classes by creating synthetic instances over the minority class until reaching a balance between both classes. It is noteworthy that these sampling techniques were performed within each fold of the training process to mitigate the risk of overfitting and ensure a more robust model evaluation. By balancing the classes and mitigating bias during the training phase, the model can better capture the characteristics of both the majority and minority classes. This leads to more accurate predictions, improves overall performance, and reduces the potential for biases.</p></sec><sec id="sec2dot5-jcm-13-04825"><title>2.5. Model Creation</title><p>The hyperparameter tuning was conducted using randomized search, with the objective of optimizing the precision score. Precision is calculated following this formula:<disp-formula id="FD1-jcm-13-04825"><mml:math id="mm1" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>&#160;</mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mo>&#160;</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>&#160;</mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mo>&#160;</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>&#160;</mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mo>&#160;</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>This approach involves randomly sampling combinations of hyperparameters within specified ranges, to find the set of hyperparameters that maximizes the performance metric. Precision was chosen as a metric, since it limits the number of false positives (negative samples incorrectly classified as positive). This means that if a patient is classified as a potential future dropout by our models, they have a very high probability of being one and as such require special attention.</p><p>To evaluate the models, we will use the precision score averaged over the 10 folds of the training process and then compute the 95% confidence interval with the standard deviation of each series. Two models with overlapping confidence intervals cannot be distinguished in terms of performance and will therefore be considered equivalent. This helps to ensure that the difference in performance is not due to chance and reflects the intrinsic qualities of each model.</p></sec><sec sec-type="methods" id="sec2dot6-jcm-13-04825"><title>2.6. Explainability Methodology</title><p>Since meta-classifiers MLP and SVC are black-box models, the SHAP (SHapley Additive exPlanations) approach is applied to give an insight into the inputs&#8217; influence over the decision [<xref rid="B29-jcm-13-04825" ref-type="bibr">29</xref>]. SHAP is a game-theoretic method that provides explanations for the output of any machine learning model. By leveraging classic Shapley values from game theory and their related extensions, SHAP connects the optimal credit allocation with local explanations. This approach allows for a comprehensive understanding of how inputs contribute to the model&#8217;s output, revealing their specific influence on the final predictions. </p><p>Two types of graphs are generated to analyze the results of the SHAP computation: (1) The first is a bar graph showing the absolute Shapley value associated with each input. It displays the most important ones, no matter whether their influence on the prediction is positive or negative. And (2), the second is a scatter graph presenting the distribution of the values taken by each input on the Shapley values scale, each dot representing one patient. It explains how each feature influences the prediction.</p></sec><sec id="sec2dot7-jcm-13-04825"><title>2.7. Experimental Setup</title><p>We used different procedures for different aspects of data processing and model creation. Concretely, the feature engineering was performed using R 4.1.0, while the machine learning was conducted using Python 3.8.10. The experiments were conducted using the CUDA Toolkit 11.3 on an Ubuntu Server LTS 20.04.4 with a GPU (NVIDIA GeForce RTX 3090 24 GB), Intel i9-12900K, and 32 GB RAM. To ensure reproducibility, all the materials and results have been published in an online repository (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://medal.ctb.upm.es/internal/gitlab/compara/mldropoutalcohol">https://medal.ctb.upm.es/internal/gitlab/compara/mldropoutalcohol</uri> accessed on 12 August 2024).</p></sec></sec><sec sec-type="results" id="sec3-jcm-13-04825"><title>3. Results</title><sec id="sec3dot1-jcm-13-04825"><title>3.1. Model Selection</title><p>The training of all seven models was carried out on the four datasets, to determine which dataset and algorithm produced the best output score. The objective was to identify the model with the highest precision score, and, in the case of similar results, use F1 and recall scores as tie-breakers. The results of the best performing model on all four datasets are summed up in <xref rid="jcm-13-04825-t001" ref-type="table">Table 1</xref>. A detailed spreadsheet with the results of all the tested algorithms across the four datasets is available online (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://medal.ctb.upm.es/internal/gitlab/compara/mldropoutalcohol/blob/master/results/models_results.xlsx">https://medal.ctb.upm.es/internal/gitlab/compara/mldropoutalcohol/blob/master/results/models_results.xlsx</uri> accessed on 12 August 2024).</p><p>Two datasets stood out for their high precision score: the one with clustering but no filtering, with a score of 0.825 &#177; 0.006, and the one with no clustering but filtering, with a score of 0.824 &#177; 0.002. As the difference in precision is not significant, we compared the <italic toggle="yes">F</italic>1 and recall scores to choose the best one (filtering but no clustering). The recall and <italic toggle="yes">F</italic>1 (considering current recall and previous precision formulas) formulas are defined below:<disp-formula id="FD2-jcm-13-04825"><mml:math id="mm2" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>&#160;</mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mo>&#160;</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>&#160;</mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mo>&#160;</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>&#160;</mml:mo><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mo>&#160;</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD3-jcm-13-04825"><mml:math id="mm3" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#8727;</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>&#8727;</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Regarding the model selection on the filtered and non-clustered dataset, the three best-performing models have an overlapping confidence interval (see <xref rid="jcm-13-04825-f002" ref-type="fig">Figure 2</xref>). Consequently, their difference in performances is not statistically significant. However, their precision scores are significantly better than all the other models. As a matter of fact, we can conclude that SVC, MLP, and logistic regression are the best choices out of the seven tested. They have a precision ranging from 0.824 &#177; 0.002 to 0.8204 &#177; 0.003, an F1 score between 0.671 &#177; 0.006 and 0.64 &#177; 0.02, and a recall score from 0.567 &#177; 0.007 to 0.533 &#177; 0.008.</p></sec><sec id="sec3dot2-jcm-13-04825"><title>3.2. Performance of the Model in a Real Scenario</title><p>We also conducted one extra testing, to assess the models&#8217; performance in a real-world case scenario. To do so, we separated a set of data (10% of the entire dataset) at the first stage of the learning process, which was reserved just for computing the final evaluation metrics. No sampling or parameter tuning was carried out from this test set. We performed this external evaluation in the four pipelines previously described: (i) without filtering variables and without clustering, (ii) without filtering the variables but clustering them, (iii) filtering the variables but without clustering them, and (iv) filtering and clustering the variables. The results are displayed in <xref rid="jcm-13-04825-t002" ref-type="table">Table 2</xref>. We implemented this process with the SVC method, given that it was the one generally working better in the previous testing.</p></sec><sec id="sec3dot3-jcm-13-04825"><title>3.3. Explainability Results</title><p>For the sake of simplicity, the explainability study was conducted on the best performing combination of model/dataset: the SVC algorithm with the filtered/non-cluster dataset. <xref rid="jcm-13-04825-f003" ref-type="fig">Figure 3</xref> shows a bar graph with the 10 most influential features.</p><p>The average importance of a variable is about 0.05, implying that the first three features have a greater-than-average performance. The next three are in the expected range, and the last four are above average. The remaining nine features are thus not shown, since we want to focus on the most influential ones.</p><p>The SHAP value plot illustrates key variables influencing the likelihood of a patient abandoning alcohol abuse treatment. Notably, the absence of previous opioid substitution treatment and coordinated mental health services are significant predictors. These factors suggest that patients who have not experienced structured, integrated care are more prone to treatment dropout. Additionally, the regular consumption of other drugs and the presence of stimulant abuse highlight the complexities of poly-substance use, which can undermine the focus and success of alcohol-specific treatment.</p><p>Mental health variables also play a critical role. The absence of mixed anxiety and mood disorders, depressive episodes, and hypnotics/sedative use disorders might indicate a lack of comprehensive mental health support, making it easier for patients to disengage from treatment. Conversely, comorbid conditions like cannabis use disorder add complexity, increasing the likelihood of treatment abandonment. Overall, these variables underscore the importance of integrated and multifaceted treatment approaches, to enhance adherence and reduce dropout rates in alcohol abuse programs.</p><p>To further analyze their influence over the prediction, <xref rid="jcm-13-04825-f004" ref-type="fig">Figure 4</xref> presents a scatter graph showing the distribution of input values as a function of the associated Shapley value. It mainly leads to interpreting each input as being positively or negatively correlated with the output.</p><p>From these results, we can infer how each variable influenced the prediction and to what extent. <xref rid="jcm-13-04825-f004" ref-type="fig">Figure 4</xref> represents in red the instances that have a specific value [value indicated between brackets] next to the variable. Blue dots represent the instances that take the other possible value for each variable. The fact that the patient had ever received opioid substitution treatment (blue dots in the first row in <xref rid="jcm-13-04825-f004" ref-type="fig">Figure 4</xref>) is highly correlated with the output, which means that a patient who has ever received such treatment is deemed by our model to have a high probability of dropping out. On the other hand, having not received this treatment before has almost no influence in the model towards classifying a patient as to not dropping out. In other words, on the one hand, the points associated with a patient that has never had a substitution treatment (red points) are very close to the origin of the plot. They range from &#8722;0.05 to 0, which means that they have a marginal negative influence over the prediction of someone as a dropout. On the other hand, the points associated with patients that have had an opioid-based substitute treatment (blue points) have a scarce distribution ranging from 0.3 to 0.8. Indeed, having received such treatment in the past has a lot of influence over the classification of the patient as a dropout.</p><p>A similar interpretation can be drawn for most of the other inputs considered. On the one hand, a patient who is simultaneously undergoing a treatment for mental disorders has a very high chance of being a dropout. On the other hand, not following such a treatment does not have an influence in the model to classify the patient as to not dropping out. Similarly, a patient who consumes another drug once a week has a very high chance of being classified as a dropout, but not doing so is not correlated with dropout probability. In a similar way, patients who have anxiety disorders, depressive episodes, or disorders due to the use of hypno-sedatives are considered by the model as at a very high risk of dropping out. However, not presenting such behaviors has only an unimportant influence on lowering the estimated dropout rate. Out of the ten most influential inputs, two of them actually help to characterize patients who will not drop out. These are the eighth and tenth criteria: disorders due to cannabis and tobacco consumption. This time, the distribution is scarce on the negative Shapley value half-plane and compact close to zero on the positive Shapley value half-plane. Consequently, the model interprets having cannabis or tobacco-related disorders as a sign that the patient is at a significantly lower risk of dropping out. However, the model does not interpret not presenting these addictions as very significant.</p></sec></sec><sec sec-type="discussion" id="sec4-jcm-13-04825"><title>4. Discussion</title><p>This study applied machine learning techniques to identify predictors of treatment discontinuation in an unprecedentedly large sample of 30,000 participants monitored via a state-wide health information system. This unique sample allowed us to directly compare the utility of different cutting-edge machine learning approaches, as well as identifying variables related to alcohol consumption, other substance use, and psychiatric comorbidities as key predictors of treatment discontinuation.</p><p>Firstly, there are different ML algorithms or techniques that can help to create models to discern whether or not a patient is going to abandon their therapeutic process. The use of a large dataset allowed us to effectively compare several different algorithms, and to identify those with a better precision in outcome prediction. This through-comparison and selection process facilitates translation potential, as the identified algorithm is likely to predict clinical outcomes with a minimal risk of false positives. On the other hand, the dataset and analytic approach also enabled us to effectively combine black-box algorithms with explainability approaches. This combination marries the computational advantages of SVC with the explanatory power of SHAP and yields both a high precision and conceptual value by qualifying the most meaningful predictors and their directionality. This combo approach may enable new applications of black-box algorithms. As seen in the present study, highly complex algorithms such as the multi-layer perceptron (MLP) or support vector classifier (SVC) generally perform well in identifying patients who will potentially drop out of treatment. The accuracy measures, which allow us to measure the proportion of true positive predictions, are above 80%.</p><p>Moreover, explainability is an important factor in these models. Given that the models that have obtained the best efficiency are black-box models, this manuscript presents an analysis of their main characteristics through the SHAP approach, which allows a clearer understanding of the main variables that are influencing the model. This methodological approach is novel with respect to existing studies that apply artificial intelligence techniques to predict a therapeutic outcome in substance use disorder patients [<xref rid="B30-jcm-13-04825" ref-type="bibr">30</xref>]. In addition, its extrapolation to other treatments for patients with mental health problems in general, where high rates of treatment abandonment and non-compliance with medical prescriptions are observed, should be assessed [<xref rid="B31-jcm-13-04825" ref-type="bibr">31</xref>].</p><p>Specific predictors included a prior history of opioid substitution treatment (OST) and comorbidities with other substance use and mental disorders. Together, these findings suggest that participants with AUD, plus other manifestations of mental ill-health, are the ones at a higher risk of discontinuation of treatment, and in need of adjunctive or more intensive interventions. The impact of OST was unexpected and probably reflects the influence of a history of opioid use disorder, which is also consistent with the predicting relevance of other drug use, as other studies have shown [<xref rid="B32-jcm-13-04825" ref-type="bibr">32</xref>]. The impact of the concurrent use of mental health services suggests that a broader and more intense psychopathology profile is linked to risk of discontinuation of addiction treatment. In this regard, the findings of machine learning methods align with the classic clinical literature regarding the influence of comorbidities and clinical &#8220;complexity&#8221; [<xref rid="B33-jcm-13-04825" ref-type="bibr">33</xref>].</p><p>With respect to this, we believe that studying these patients using dimensional models, such as the Hierarchical Taxonomy of Psychopathology [<xref rid="B34-jcm-13-04825" ref-type="bibr">34</xref>] of the Research Domain Criteria [<xref rid="B35-jcm-13-04825" ref-type="bibr">35</xref>], could better capture these psychopathological characteristics and be useful for predicting treatment retention. This also aligns with current policy discussions, such as which is the best approach for treating addictive disorders (i.e., parallel or integrated pathways with mental health services). In this vein, several studies have shown that people with alcohol and other substance use disorders and mental health comorbidities spend less time in treatment and have a greater risk of discontinuation. However, those patients with comorbidities that undergo customized integrated treatments can achieve a similar therapeutic success to patients without comorbidities. Thus, the present study, which was conducted on a large sample using real-world data, seems to reflect that the current mainstream treatment approach may not be catering to the needs of patients with comorbidities,</p><p>Despite our large sample and innovative approach, we should also acknowledge some limitations. Firstly, the sample was mainly composed of male participants. This probably reflects the uneven distribution of gender in the target population, as reflected in several epidemiology reports [<xref rid="B36-jcm-13-04825" ref-type="bibr">36</xref>]. However, it also indicates that new efforts are needed to better understand predictors of treatment outcomes, specifically among women. Regarding the limitations of the analyses, it should be noted that due to the existing imbalance between classes, the application of balancing techniques always implies a decrease in instances of a class (undersampling) or the synthetic generation of the minority class (oversampling). Although, as mentioned in this article, the use of these techniques was used to mitigate the risk of overfitting and ensure a more robust model evaluation, it is true that having a more balanced dataset from the original data will always produce better results.</p><p>In terms of results, the approach used has allowed us to discern, using variable filtering techniques and clustering approaches, which is the best potential dataset and the best technique that offers the most robust results for the detection of dropout. Although the results are promising and it is considered that a series of models with high precision values have been obtained, future research where access to other types of variables that could improve the characterization of the patient, in order to define their potential dropout likelihood, would be very useful.</p><p>Regarding the limits of the SHAP algorithm, one of the main assumptions made is that the variables are independent. Since the filtering applied to the dataset requires the highly correlated variables to be excluded, the remaining ones have a low correlation rate. However, this does not mean that they are independent stricto sensu. Furthermore, one should bear in mind that SHAP is not a measure of the importance of the variables in a real-life phenomenon but rather an insight into the functioning of a machine learning algorithm. Such models find patterns in data, and the SHAP analysis highlights them. However, the trends observed do not demonstrate in any way a causal link between a variable and a phenomenon.</p><p>A final comment on this section needs to be made with respect to the separation of the dataset in the training and test sets. We acknowledge the importance of strictly separating the training and test data before performing steps such as feature selection, normalization, imputation, hyperparameter tuning, and model selection. We understand that this is a critical aspect of preventing data leakage and ensuring the generalizability of the model. However, in our case, we did not strictly adhere to the pre-split procedure; we have taken several measures, including the additional experiments shown in <xref rid="sec3dot2-jcm-13-04825" ref-type="sec">Section 3.2</xref>, to mitigate potential biases and ensure the robustness of our model. Concretely, we would like to emphasize the importance of employing cross-validation techniques to evaluate the model&#8217;s performance. This method involves dividing the data into multiple folds, ensuring that the training and test data are separated within each fold. Although this does not replace a strict pre-split, it does provide a robust mechanism to assess the model&#8217;s generalizability across different subsets of the data. On the other hand, the feature selection process was guided by domain knowledge and statistical analyses independent of the model training process. While this was carried out before the splitting, the choice of features was not influenced by the test data but was based on their inherent characteristics, thus reducing the risk of overfitting. Finally, these steps were performed using parameters derived from the entire dataset. While ideally carried out post-split, we believe the impact on the model&#8217;s performance is minimal due to the cross-validation process, which ensures that the test data in each fold remain unseen during the model&#8217;s fitting phase. We recognize the ideal methodological approach would have involved a pre-split of the data. However, given the constraints and the data availability at the time, we prioritized a methodologically sound approach using cross-validation, which is widely accepted as a rigorous evaluation method, and we performed the additional experiments provided in <xref rid="sec3dot2-jcm-13-04825" ref-type="sec">Section 3.2</xref> to increase the validity of the results.</p></sec><sec sec-type="conclusions" id="sec5-jcm-13-04825"><title>5. Conclusions</title><p>In conclusion, our machine learning approach to predicting treatment dropout for alcohol use disorder (AUD) demonstrates significant potential for a broader application across various health conditions. This methodology can be effectively extended to other substance use disorders, chronic diseases such as diabetes and hypertension, mental health disorders, rehabilitation programs, and preventive health initiatives. By accurately identifying patients at a higher risk of discontinuing treatment, we can develop and implement targeted retention strategies, thus improving treatment adherence and outcomes across diverse medical and therapeutic contexts. This highlights the versatility and practical utility of our approach in enhancing patient care and treatment success.</p></sec></body><back><ack><title>Acknowledgments</title><p>This study has been developed thanks to the transfer of data by the Department of Equality, Social Policies, and Conciliation of the Junta de Andaluc&#237;a.</p></ack><fn-group><fn><p><bold>Disclaimer/Publisher&#8217;s Note:</bold> The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content.</p></fn></fn-group><notes><title>Author Contributions</title><p>Conceptualization, all authors; methodology, A.C., A.A.-M., P.T.-N., L.P.-S. and A.R.-G.; software, A.C. and A.A.-M.; investigation, all authors; data curation, A.V.-G., C.D.-B., F.F.-C., N.A.-U. and &#211;.M.L.; writing&#8212;original draft preparation, A.C., A.A.-M., P.T.-N., F.F.-C. and &#211;.M.L.; writing&#8212;review and editing, all authors.; supervision, &#211;.M.L. and A.R.-G.; funding acquisition, &#211;.M.L. and A.R.-G. All authors have read and agreed to the published version of the manuscript.</p></notes><notes><title>Institutional Review Board Statement</title><p>The study was conducted in accordance with the Declaration of Helsinki, and approved by the Andalusian Ministry of Health&#8217;s Research Ethics Committee (protocol code 0661-N-22 and date of approval 22 April 2022).</p></notes><notes><title>Informed Consent Statement</title><p>Not applicable.</p></notes><notes notes-type="data-availability"><title>Data Availability Statement</title><p>All additional data is available at: <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://medal.ctb.upm.es/internal/gitlab/compara/mldropoutalcohol">https://medal.ctb.upm.es/internal/gitlab/compara/mldropoutalcohol</uri> (accessed on 13 August 2024).</p></notes><notes notes-type="COI-statement"><title>Conflicts of Interest</title><p>The authors declare that they have no conflicts of interest.</p></notes><ref-list><title>References</title><ref id="B1-jcm-13-04825"><label>1.</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>World Health Organization</collab></person-group><article-title>World Health Statistics 2023: Monitoring Health for the SDGs, Sustainable Development Goals</article-title><comment>Available online: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.who.int/publications/i/item/9789240074323" ext-link-type="uri">https://www.who.int/publications/i/item/9789240074323</ext-link></comment><date-in-citation content-type="access-date" iso-8601-date="2024-08-13">(accessed on 13 August 2024)</date-in-citation></element-citation></ref><ref id="B2-jcm-13-04825"><label>2.</label><element-citation publication-type="gov"><person-group person-group-type="author"><collab>Substance Abuse and Mental Heatlh Services Administration, Center for behavioral Health Statistics and Quality</collab></person-group><article-title>Treatment Episode Data Set (TEDS): 2020 Admissions to and Discharges from Publicly Funded Substance Use Treatment Facilities | CBHSQ Data</article-title><comment>Available online: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.samhsa.gov/data/report/treatment-episode-data-set-teds-2020-admissions" ext-link-type="uri">https://www.samhsa.gov/data/report/treatment-episode-data-set-teds-2020-admissions</ext-link></comment><date-in-citation content-type="access-date" iso-8601-date="2024-06-14">(accessed on 14 June 2024)</date-in-citation></element-citation></ref><ref id="B3-jcm-13-04825"><label>3.</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>Observatorio Espa&#241;ol de las Drogas y las Adicciones</collab></person-group><article-title>INFORME 2022</article-title><source>Alcohol, Tabaco y Drogas Ilegales en Espa&#241;a.</source><year>2022</year><comment>Available online: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://pnsd.sanidad.gob.es/profesionales/sistemasInformacion/informesEstadisticas/pdf/2022OEDA-INFORME.pdf" ext-link-type="uri">https://pnsd.sanidad.gob.es/profesionales/sistemasInformacion/informesEstadisticas/pdf/2022OEDA-INFORME.pdf</ext-link></comment><date-in-citation content-type="access-date" iso-8601-date="2024-06-14">(accessed on 14 June 2024)</date-in-citation></element-citation></ref><ref id="B4-jcm-13-04825"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Witkiewitz</surname><given-names>K.</given-names></name><name name-style="western"><surname>Litten</surname><given-names>R.Z.</given-names></name><name name-style="western"><surname>Leggio</surname><given-names>L.</given-names></name></person-group><article-title>Advances in the science and treatment of alcohol use disorder</article-title><source>Sci. Adv.</source><year>2019</year><volume>5</volume><fpage>eaax4043</fpage><pub-id pub-id-type="doi">10.1126/sciadv.aax4043</pub-id><pub-id pub-id-type="pmid">31579824</pub-id><pub-id pub-id-type="pmcid">PMC6760932</pub-id></element-citation></ref><ref id="B5-jcm-13-04825"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dellazizzo</surname><given-names>L.</given-names></name><name name-style="western"><surname>Potvin</surname><given-names>S.</given-names></name><name name-style="western"><surname>Gigu&#232;re</surname><given-names>S.</given-names></name><name name-style="western"><surname>Landry</surname><given-names>C.</given-names></name><name name-style="western"><surname>L&#233;veill&#233;</surname><given-names>N.</given-names></name><name name-style="western"><surname>Dumais</surname><given-names>A.</given-names></name></person-group><article-title>Meta-review on the efficacy of psychological therapies for the treatment of substance use disorders</article-title><source>Psychiatry Res.</source><year>2023</year><volume>326</volume><fpage>115318</fpage><pub-id pub-id-type="doi">10.1016/j.psychres.2023.115318</pub-id><pub-id pub-id-type="pmid">37356250</pub-id></element-citation></ref><ref id="B6-jcm-13-04825"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Koob</surname><given-names>G.F.</given-names></name></person-group><article-title>Alcohol Use Disorder Treatment: Problems and solutions</article-title><source>Annu. Rev. Pharmacol. Toxicol.</source><year>2024</year><volume>64</volume><fpage>255</fpage><lpage>275</lpage><pub-id pub-id-type="doi">10.1146/annurev-pharmtox-031323-115847</pub-id><pub-id pub-id-type="pmid">38261428</pub-id></element-citation></ref><ref id="B7-jcm-13-04825"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dalton</surname><given-names>K.</given-names></name><name name-style="western"><surname>Bishop</surname><given-names>L.</given-names></name><name name-style="western"><surname>Darcy</surname><given-names>S.</given-names></name></person-group><article-title>Investigating interventions that lead to the highest treatment retention for emerging adults with substance use disorder: A systematic review</article-title><source>Addict. Behav.</source><year>2021</year><volume>122</volume><fpage>107005</fpage><pub-id pub-id-type="doi">10.1016/j.addbeh.2021.107005</pub-id><pub-id pub-id-type="pmid">34119856</pub-id></element-citation></ref><ref id="B8-jcm-13-04825"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Carvalho</surname><given-names>A.F.</given-names></name><name name-style="western"><surname>Heilig</surname><given-names>M.</given-names></name><name name-style="western"><surname>Perez</surname><given-names>A.</given-names></name><name name-style="western"><surname>Probst</surname><given-names>C.</given-names></name><name name-style="western"><surname>Rehm</surname><given-names>J.</given-names></name></person-group><article-title>Alcohol use disorders</article-title><source>Lancet</source><year>2019</year><volume>394</volume><fpage>781</fpage><lpage>792</lpage><pub-id pub-id-type="doi">10.1016/S0140-6736(19)31775-1</pub-id><pub-id pub-id-type="pmid">31478502</pub-id></element-citation></ref><ref id="B9-jcm-13-04825"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Simpson</surname><given-names>D.D.</given-names></name></person-group><article-title>A conceptual framework for transferring research to practice</article-title><source>J. Subst. Abus. Treat.</source><year>2002</year><volume>22</volume><fpage>171</fpage><lpage>182</lpage><pub-id pub-id-type="doi">10.1016/S0740-5472(02)00231-3</pub-id><pub-id pub-id-type="pmid">12072162</pub-id></element-citation></ref><ref id="B10-jcm-13-04825"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dacosta-S&#225;nchez</surname><given-names>D.</given-names></name><name name-style="western"><surname>Fern&#225;ndez-Calder&#243;n</surname><given-names>F.</given-names></name><name name-style="western"><surname>D&#237;az-Batanero</surname><given-names>C.</given-names></name><name name-style="western"><surname>Manche&#241;o-Velasco</surname><given-names>C.</given-names></name><name name-style="western"><surname>Lozano</surname><given-names>&#211;.M.</given-names></name></person-group><article-title>Modeling the Therapeutic Process of Patients with Cocaine Use Disorders: A Guide for Predicting Readmission</article-title><source>Eur. Addict. Res.</source><year>2024</year><volume>30</volume><fpage>80</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1159/000535689</pub-id><pub-id pub-id-type="pmid">38437822</pub-id></element-citation></ref><ref id="B11-jcm-13-04825"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mladenovic</surname><given-names>I.</given-names></name><name name-style="western"><surname>Perunicic-Mladenovic</surname><given-names>I.</given-names></name><name name-style="western"><surname>Dimitrijevic</surname><given-names>I.</given-names></name></person-group><article-title>Clinical and background risk factors affectinf dropouts from Alcohol Use DIsorder treatment: A 25-year retrospective study</article-title><source>Int. J. Ment. Health Addict.</source><year>2023</year><pub-id pub-id-type="doi">10.1007/s11469-023-01196-7</pub-id></element-citation></ref><ref id="B12-jcm-13-04825"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dacosta-S&#225;nchez</surname><given-names>D.</given-names></name><name name-style="western"><surname>Gonz&#225;lez-Ponce</surname><given-names>B.M.</given-names></name><name name-style="western"><surname>Fern&#225;ndez-Calder&#243;n</surname><given-names>F.</given-names></name><name name-style="western"><surname>S&#225;nchez-Garc&#237;a</surname><given-names>M.</given-names></name><name name-style="western"><surname>Lozano</surname><given-names>O.M.</given-names></name></person-group><article-title>Retention in treatment and therapeutic adherence: How are these associated with therapeutic success? An analysis using real-world data</article-title><source>Int. J. Methods Psychiatr. Res.</source><year>2022</year><volume>31</volume><fpage>e1929</fpage><pub-id pub-id-type="doi">10.1002/mpr.1929</pub-id><pub-id pub-id-type="pmid">35765238</pub-id><pub-id pub-id-type="pmcid">PMC9720222</pub-id></element-citation></ref><ref id="B13-jcm-13-04825"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Garbin</surname><given-names>C.</given-names></name><name name-style="western"><surname>Marques</surname><given-names>N.</given-names></name><name name-style="western"><surname>Marques</surname><given-names>O.</given-names></name></person-group><article-title>Machine learning for predicting opioid use disorder from healthcare data: A systematic review</article-title><source>Comput. Methods Programs Biomed.</source><year>2023</year><volume>236</volume><elocation-id>107573</elocation-id><pub-id pub-id-type="doi">10.1016/j.cmpb.2023.107573</pub-id><pub-id pub-id-type="pmid">37148670</pub-id></element-citation></ref><ref id="B14-jcm-13-04825"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Barenholtz</surname><given-names>E.</given-names></name><name name-style="western"><surname>Fitzgerald</surname><given-names>N.D.</given-names></name><name name-style="western"><surname>Hahn</surname><given-names>W.E.</given-names></name></person-group><article-title>Machine-learning approaches to substance-abuse research: Emerging trends and their implications</article-title><source>Curr. Opin. Psychiatry</source><year>2020</year><volume>33</volume><fpage>334</fpage><pub-id pub-id-type="doi">10.1097/YCO.0000000000000611</pub-id><pub-id pub-id-type="pmid">32304429</pub-id></element-citation></ref><ref id="B15-jcm-13-04825"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>L.</given-names></name><name name-style="western"><surname>Du</surname><given-names>Y.</given-names></name><name name-style="western"><surname>Yang</surname><given-names>W.</given-names></name><name name-style="western"><surname>Liu</surname><given-names>J.</given-names></name></person-group><article-title>Machine learning with neuroimaging biomarkers: Application in the diagnosis and prediction of drug addiction</article-title><source>Addict. Biol.</source><year>2023</year><volume>28</volume><elocation-id>e13267</elocation-id><pub-id pub-id-type="doi">10.1111/adb.13267</pub-id><pub-id pub-id-type="pmid">36692873</pub-id></element-citation></ref><ref id="B16-jcm-13-04825"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cavicchioli</surname><given-names>M.</given-names></name><name name-style="western"><surname>Calesella</surname><given-names>F.</given-names></name><name name-style="western"><surname>Cazzetta</surname><given-names>S.</given-names></name><name name-style="western"><surname>Mariagrazia</surname><given-names>M.</given-names></name><name name-style="western"><surname>Ogliari</surname><given-names>A.</given-names></name><name name-style="western"><surname>Maffei</surname><given-names>C.</given-names></name><name name-style="western"><surname>Vai</surname><given-names>B.</given-names></name></person-group><article-title>Investigating predictive factors of dialectical behavior therapy skills training efficacy for alcohol and concurrent substance use disorders: A machine learning study</article-title><source>Drug Alcohol Depend.</source><year>2021</year><volume>224</volume><fpage>108723</fpage><pub-id pub-id-type="doi">10.1016/j.drugalcdep.2021.108723</pub-id><pub-id pub-id-type="pmid">33965687</pub-id></element-citation></ref><ref id="B17-jcm-13-04825"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Park</surname><given-names>S.J.</given-names></name><name name-style="western"><surname>Lee</surname><given-names>S.J.</given-names></name><name name-style="western"><surname>Kim</surname><given-names>H.</given-names></name><name name-style="western"><surname>Kim</surname><given-names>J.K.</given-names></name><name name-style="western"><surname>Chun</surname><given-names>J.W.</given-names></name><name name-style="western"><surname>Lee</surname><given-names>S.J.</given-names></name><name name-style="western"><surname>Lee</surname><given-names>H.K.</given-names></name><name name-style="western"><surname>Kim</surname><given-names>D.J.</given-names></name><name name-style="western"><surname>Choi</surname><given-names>I.Y.</given-names></name></person-group><article-title>Machine learning prediction of dropping out of outpatients with alcohol use disorders</article-title><source>PLoS ONE</source><year>2021</year><volume>16</volume><elocation-id>e0255626</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0255626</pub-id><pub-id pub-id-type="pmid">34339461</pub-id><pub-id pub-id-type="pmcid">PMC8328309</pub-id></element-citation></ref><ref id="B18-jcm-13-04825"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Roberts</surname><given-names>W.</given-names></name><name name-style="western"><surname>Zhao</surname><given-names>Y.</given-names></name><name name-style="western"><surname>Verplaetse</surname><given-names>T.</given-names></name><name name-style="western"><surname>Moore</surname><given-names>K.E.</given-names></name><name name-style="western"><surname>Peltier</surname><given-names>M.R.</given-names></name><name name-style="western"><surname>Burke</surname><given-names>C.</given-names></name><name name-style="western"><surname>Zakiniaeiz</surname><given-names>Y.</given-names></name><name name-style="western"><surname>McKee</surname><given-names>S.</given-names></name></person-group><article-title>Using machine learning to predict heavy drinking during outpatient alcohol treatment</article-title><source>Alcohol. Clin. Exp. Res.</source><year>2022</year><volume>46</volume><fpage>657</fpage><lpage>666</lpage><pub-id pub-id-type="doi">10.1111/acer.14802</pub-id><pub-id pub-id-type="pmid">35420710</pub-id><pub-id pub-id-type="pmcid">PMC9180421</pub-id></element-citation></ref><ref id="B19-jcm-13-04825"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wallach</surname><given-names>J.D.</given-names></name><name name-style="western"><surname>Gueorguieva</surname><given-names>R.</given-names></name><name name-style="western"><surname>Phan</surname><given-names>H.</given-names></name><name name-style="western"><surname>Witkiewitz</surname><given-names>K.</given-names></name><name name-style="western"><surname>Wu</surname><given-names>R.</given-names></name><name name-style="western"><surname>O&#8217;Malley</surname><given-names>S.S.</given-names></name></person-group><article-title>Predictors of abstinence, no heavy drinking days, and a 2-level reduction in World Health Organization drinking levels during treatment for alcohol use disorder in the COMBINE study</article-title><source>Alcohol. Clin. Exp. Res.</source><year>2022</year><volume>46</volume><fpage>1331</fpage><lpage>1339</lpage><pub-id pub-id-type="doi">10.1111/acer.14877</pub-id><pub-id pub-id-type="pmid">35616436</pub-id><pub-id pub-id-type="pmcid">PMC9887652</pub-id></element-citation></ref><ref id="B20-jcm-13-04825"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schwebel</surname><given-names>F.J.</given-names></name><name name-style="western"><surname>Emery</surname><given-names>N.N.</given-names></name><name name-style="western"><surname>Pfund</surname><given-names>R.A.</given-names></name><name name-style="western"><surname>Pearson</surname><given-names>M.R.</given-names></name><name name-style="western"><surname>Witkiewitz</surname><given-names>K.</given-names></name></person-group><article-title>Using machine learning to examine predictors of treatment goal change among individuals seeking treatment for alcohol use disorder</article-title><source>J. Subst. Abus. Treat.</source><year>2022</year><volume>140</volume><fpage>108825</fpage><pub-id pub-id-type="doi">10.1016/j.jsat.2022.108825</pub-id><pub-id pub-id-type="pmid">35759802</pub-id><pub-id pub-id-type="pmcid">PMC9708382</pub-id></element-citation></ref><ref id="B21-jcm-13-04825"><label>21.</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>European Monitoring Center for Drugs and Drug Addiction (EMCDDA)</collab></person-group><article-title>Treatment demand indicator (TDI) Standard Protocol 3.0: Guidelines for Reporting Data on People Entering Drug Treatment in European Countries | www.emcdda.europa.eu</article-title><comment>Available online: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.emcdda.europa.eu/publications/manuals/tdi-protocol-3.0_en" ext-link-type="uri">https://www.emcdda.europa.eu/publications/manuals/tdi-protocol-3.0_en</ext-link></comment><date-in-citation content-type="access-date" iso-8601-date="2024-06-14">(accessed on 14 June 2024)</date-in-citation></element-citation></ref><ref id="B22-jcm-13-04825"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dacosta-S&#225;nchez</surname><given-names>D.</given-names></name><name name-style="western"><surname>D&#237;az-Batanero</surname><given-names>C.</given-names></name><name name-style="western"><surname>Fern&#225;ndez-Calder&#243;n</surname><given-names>F.</given-names></name><name name-style="western"><surname>Lozano</surname><given-names>O.M.</given-names></name></person-group><article-title>Impact of Ccuster B personality disorders in drugs therapeutic community treatment outcomes: A study based on real world data</article-title><source>J. Clin. Med.</source><year>2021</year><volume>10</volume><elocation-id>2572</elocation-id><pub-id pub-id-type="doi">10.3390/jcm10122572</pub-id><pub-id pub-id-type="pmid">34200750</pub-id><pub-id pub-id-type="pmcid">PMC8230360</pub-id></element-citation></ref><ref id="B23-jcm-13-04825"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dacosta-S&#225;nchez</surname><given-names>D.</given-names></name><name name-style="western"><surname>Fern&#225;ndez-Calder&#243;n</surname><given-names>F.</given-names></name><name name-style="western"><surname>Blanc-Molina</surname><given-names>A.</given-names></name><name name-style="western"><surname>D&#237;az-Batanero</surname><given-names>C.</given-names></name><name name-style="western"><surname>Lozano</surname><given-names>O.M.</given-names></name></person-group><article-title>Monitoring adherence and abstinence of cannabis use disorder patients: Profile identification and relationshihp with long-term treatment outcomes</article-title><source>J. Subst. Use Addict. Treat.</source><year>2023</year><volume>148</volume><fpage>209019</fpage><pub-id pub-id-type="doi">10.1016/j.josat.2023.209019</pub-id><pub-id pub-id-type="pmid">36933660</pub-id></element-citation></ref><ref id="B24-jcm-13-04825"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shearer</surname><given-names>C.</given-names></name></person-group><article-title>The CRISP-DM model: The new blueprint for data mining</article-title><source>J. Data Warehous.</source><year>2000</year><volume>5</volume><fpage>13</fpage><lpage>22</lpage></element-citation></ref><ref id="B25-jcm-13-04825"><label>25.</label><element-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Hall</surname><given-names>M.A.</given-names></name><name name-style="western"><surname>Smith</surname><given-names>L.A.</given-names></name></person-group><article-title>Practical feature subset selection for machine learning</article-title><source>Computer Science &#8217;98 Proceedings of the 21st Australasian Computer Science Conference ACSC&#8217;98, Perth, 4&#8211;6 February 1998</source><person-group person-group-type="editor"><name name-style="western"><surname>McDonald</surname><given-names>C.</given-names></name></person-group><publisher-name>Springer</publisher-name><publisher-loc>Berlin/Heidelberg, Germany</publisher-loc><year>1998</year><fpage>181</fpage><lpage>191</lpage></element-citation></ref><ref id="B26-jcm-13-04825"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fernandez-Delgado</surname><given-names>M.</given-names></name><name name-style="western"><surname>Cernadas</surname><given-names>E.</given-names></name><name name-style="western"><surname>Barro</surname><given-names>S.</given-names></name><name name-style="western"><surname>Amorim</surname><given-names>D.</given-names></name></person-group><article-title>Do we Need Hundreds of Classifiers to Solve Real World Classification Problems?</article-title><source>J. Mach. Learn. Res.</source><year>2014</year><volume>15</volume><fpage>3133</fpage><lpage>3181</lpage></element-citation></ref><ref id="B27-jcm-13-04825"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chawla</surname><given-names>N.V.</given-names></name><name name-style="western"><surname>Bowyer</surname><given-names>K.W.</given-names></name><name name-style="western"><surname>Hall</surname><given-names>L.O.</given-names></name><name name-style="western"><surname>Kegelmeyer</surname><given-names>W.P.</given-names></name></person-group><article-title>SMOTE: Synthetic Minority Over-sampling Technique</article-title><source>J. Artif. Intell. Res.</source><year>2002</year><volume>16</volume><fpage>321</fpage><lpage>357</lpage><pub-id pub-id-type="doi">10.1613/jair.953</pub-id></element-citation></ref><ref id="B28-jcm-13-04825"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Swana</surname><given-names>E.F.</given-names></name><name name-style="western"><surname>Doorsamy</surname><given-names>W.</given-names></name><name name-style="western"><surname>Bokoro</surname><given-names>P.</given-names></name></person-group><article-title>Tomek Link and SMOTE Approaches for Machine Fault Classification with an Imbalanced Dataset</article-title><source>Sensors</source><year>2022</year><volume>22</volume><elocation-id>3246</elocation-id><pub-id pub-id-type="doi">10.3390/s22093246</pub-id><pub-id pub-id-type="pmid">35590937</pub-id><pub-id pub-id-type="pmcid">PMC9099503</pub-id></element-citation></ref><ref id="B29-jcm-13-04825"><label>29.</label><element-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Lundberg</surname><given-names>S.M.</given-names></name><name name-style="western"><surname>Lee</surname><given-names>S.-I.</given-names></name></person-group><article-title>A Unified Approach to Interpreting Model Predictions</article-title><source>Advances in Neural Information Processing Systems</source><publisher-name>Curran Associates, Inc.</publisher-name><publisher-loc>Long Beach, CA, USA</publisher-loc><year>2017</year><comment>Available online: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://papers.nips.cc/paper_files/paper/2017/hash/8a20a8621978632d76c43dfd28b67767-Abstract.html" ext-link-type="uri">https://papers.nips.cc/paper_files/paper/2017/hash/8a20a8621978632d76c43dfd28b67767-Abstract.html</ext-link></comment><date-in-citation content-type="access-date" iso-8601-date="2024-06-14">(accessed on 14 June 2024)</date-in-citation></element-citation></ref><ref id="B30-jcm-13-04825"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>London</surname><given-names>A.J.</given-names></name></person-group><article-title>Artificial Intelligence and Black-Box Medical Decisions: Accuracy versus Explainability</article-title><source>Hastings Cent. Rep.</source><year>2019</year><volume>49</volume><fpage>15</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1002/hast.973</pub-id><pub-id pub-id-type="pmid">30790315</pub-id></element-citation></ref><ref id="B31-jcm-13-04825"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Le Glaz</surname><given-names>A.</given-names></name><name name-style="western"><surname>Haralambous</surname><given-names>Y.</given-names></name><name name-style="western"><surname>Kim-Dufor</surname><given-names>D.H.</given-names></name><name name-style="western"><surname>Lenca</surname><given-names>P.</given-names></name><name name-style="western"><surname>Billot</surname><given-names>R.</given-names></name><name name-style="western"><surname>Ryan</surname><given-names>T.C.</given-names></name><name name-style="western"><surname>Marsh</surname><given-names>J.</given-names></name><name name-style="western"><surname>Devylder</surname><given-names>J.</given-names></name><name name-style="western"><surname>Walter</surname><given-names>M.</given-names></name><name name-style="western"><surname>Berrouiguet</surname><given-names>S.</given-names></name><etal/></person-group><article-title>Machine Learning and Natural Language Processing in Mental Health: Systematic Review</article-title><source>J. Med. Internet Res.</source><year>2021</year><volume>23</volume><fpage>e15708</fpage><pub-id pub-id-type="doi">10.2196/15708</pub-id><pub-id pub-id-type="pmid">33944788</pub-id><pub-id pub-id-type="pmcid">PMC8132982</pub-id></element-citation></ref><ref id="B32-jcm-13-04825"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lappan</surname><given-names>S.N.</given-names></name><name name-style="western"><surname>Brown</surname><given-names>A.W.</given-names></name><name name-style="western"><surname>Hendricks</surname><given-names>P.S.</given-names></name></person-group><article-title>Dropout rates of in-person psychosocial substance use disorder treatments: A systematic review and meta-analysis</article-title><source>Addiction</source><year>2020</year><volume>115</volume><fpage>201</fpage><lpage>217</lpage><pub-id pub-id-type="doi">10.1111/add.14793</pub-id><pub-id pub-id-type="pmid">31454123</pub-id></element-citation></ref><ref id="B33-jcm-13-04825"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Szerman</surname><given-names>N.</given-names></name><name name-style="western"><surname>Torrens</surname><given-names>M.</given-names></name><name name-style="western"><surname>Maldonado</surname><given-names>R.</given-names></name><name name-style="western"><surname>Balhara</surname><given-names>Y.P.S.</given-names></name><name name-style="western"><surname>Salom</surname><given-names>C.</given-names></name><name name-style="western"><surname>Maremmani</surname><given-names>I.</given-names></name><name name-style="western"><surname>Sher</surname><given-names>L.</given-names></name><name name-style="western"><surname>Didia-Attas</surname><given-names>J.</given-names></name><name name-style="western"><surname>Chen</surname><given-names>J.</given-names></name><name name-style="western"><surname>Baler</surname><given-names>R.</given-names></name><etal/></person-group><article-title>Addictive and other mental disorders: A call for a standardized definition of dual disorders</article-title><source>Transl. Psychiatry</source><year>2022</year><volume>12</volume><fpage>446</fpage><pub-id pub-id-type="doi">10.1038/s41398-022-02212-5</pub-id><pub-id pub-id-type="pmid">36229453</pub-id><pub-id pub-id-type="pmcid">PMC9562408</pub-id></element-citation></ref><ref id="B34-jcm-13-04825"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kotov</surname><given-names>R.</given-names></name><name name-style="western"><surname>Krueger</surname><given-names>R.F.</given-names></name><name name-style="western"><surname>Watson</surname><given-names>D.</given-names></name><name name-style="western"><surname>Achenbach</surname><given-names>T.M.</given-names></name><name name-style="western"><surname>Althoff</surname><given-names>R.R.</given-names></name><name name-style="western"><surname>Bagby</surname><given-names>R.M.</given-names></name><name name-style="western"><surname>Brown</surname><given-names>T.A.</given-names></name><name name-style="western"><surname>Carpenter</surname><given-names>W.T.</given-names></name><name name-style="western"><surname>Caspi</surname><given-names>A.</given-names></name><name name-style="western"><surname>Clark</surname><given-names>L.A.</given-names></name><etal/></person-group><article-title>The Hierarchical Taxonomy of Psychopathology (HiTOP): A dimensional alternative to traditional nosologies</article-title><source>J. Abnorm. Psychol.</source><year>2017</year><volume>126</volume><fpage>454</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1037/abn0000258</pub-id><pub-id pub-id-type="pmid">28333488</pub-id></element-citation></ref><ref id="B35-jcm-13-04825"><label>35.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Insel</surname><given-names>T.</given-names></name><name name-style="western"><surname>Cuthbert</surname><given-names>B.</given-names></name><name name-style="western"><surname>Garvey</surname><given-names>M.</given-names></name><name name-style="western"><surname>Heinssen</surname><given-names>R.</given-names></name><name name-style="western"><surname>Pine</surname><given-names>D.S.</given-names></name><name name-style="western"><surname>Quinn</surname><given-names>K.</given-names></name><name name-style="western"><surname>Sanislow</surname><given-names>C.</given-names></name><name name-style="western"><surname>Wang</surname><given-names>P.</given-names></name></person-group><article-title>Research Domain Criteria (RDoC): Toward a New Classification Framework for Research on Mental Disorders</article-title><source>Am. J. Psychiatry</source><year>2010</year><volume>167</volume><fpage>748</fpage><lpage>751</lpage><pub-id pub-id-type="doi">10.1176/appi.ajp.2010.09091379</pub-id><pub-id pub-id-type="pmid">20595427</pub-id></element-citation></ref><ref id="B36-jcm-13-04825"><label>36.</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>European Monitoring Centre for Drugs and Drug Addiction (EMCDDA)</collab></person-group><article-title>European Drug Report 2022: Trends and Developments|www.emcdda.europa.eu</article-title><comment>Available online: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.emcdda.europa.eu/publications/edr/trends-developments/2022_en" ext-link-type="uri">https://www.emcdda.europa.eu/publications/edr/trends-developments/2022_en</ext-link></comment><date-in-citation content-type="access-date" iso-8601-date="2024-06-14">(accessed on 14 June 2024)</date-in-citation></element-citation></ref></ref-list></back><floats-group><fig position="float" id="jcm-13-04825-f001" orientation="portrait"><label>Figure 1</label><caption><p>Datasets generated depending on the application of clustering and filtering.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="jcm-13-04825-g001.jpg"/></fig><fig position="float" id="jcm-13-04825-f002" orientation="portrait"><label>Figure 2</label><caption><p>Average precision of models over 10-fold training and non-clustered dataset.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="jcm-13-04825-g002.jpg"/></fig><fig position="float" id="jcm-13-04825-f003" orientation="portrait"><label>Figure 3</label><caption><p>Ten most influential variables on the SVC model with the filtered/non-cluster dataset.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="jcm-13-04825-g003.jpg"/></fig><fig position="float" id="jcm-13-04825-f004" orientation="portrait"><label>Figure 4</label><caption><p>Graph with the distribution of input values as a function of the associated Shapley value (red implies a high value for the feature; blue implies a low value for the feature).</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="jcm-13-04825-g004.jpg"/></fig><table-wrap position="float" id="jcm-13-04825-t001" orientation="portrait"><object-id pub-id-type="pii">jcm-13-04825-t001_Table 1</object-id><label>Table 1</label><caption><p>Precision of the dataset generated.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">
</th><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">
</th><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">No Clustering</th><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Clustering</th></tr></thead><tbody><tr><td rowspan="4" align="center" valign="middle" style="border-bottom:solid thin" colspan="1">No filtering</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Precision</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.811</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.825</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">F1</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.242</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.604</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Recall</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.142</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.477</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Model</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Support vector classification</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Support vector classification</td></tr><tr><td rowspan="4" align="center" valign="middle" style="border-bottom:solid thin" colspan="1">Filtering</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Precision</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.824</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.799</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">F1</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.648</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.639</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Recall</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.534</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.557</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Model</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Support vector classification</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Multi-layer perceptron</td></tr></tbody></table></table-wrap><table-wrap position="float" id="jcm-13-04825-t002" orientation="portrait"><object-id pub-id-type="pii">jcm-13-04825-t002_Table 2</object-id><label>Table 2</label><caption><p>Performance of the models in a real scenario.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">
</th><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">
</th><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">No Clustering</th><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Clustering</th></tr></thead><tbody><tr><td rowspan="4" align="center" valign="middle" style="border-bottom:solid thin" colspan="1">No filtering</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Precision</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.777</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.777</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">F1</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.874</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.874</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Recall</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.998</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">1</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Model</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Support vector classification</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Support vector classification</td></tr><tr><td rowspan="4" align="center" valign="middle" style="border-bottom:solid thin" colspan="1">Filtering</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Precision</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.811</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.789</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">F1</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.237</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.691</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Recall</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.139</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.615</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Model</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Support vector classification</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Support vector classification</td></tr></tbody></table></table-wrap></floats-group></article></pmc-articleset>